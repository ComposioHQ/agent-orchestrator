# Agent Orchestrator â€” Marc Mantei's OpenClaw Instance
# Claude-only agent swarm for all projects

dataDir: ~/.agent-orchestrator
worktreeDir: ~/.worktrees

port: 3000

# Security: Only react to PR reviews/comments from these GitHub users.
# Prevents prompt injection from external commenters on public repos.
# Bot comments (CI, linters) are always allowed regardless.
allowedUsers:
  - marcmantei

defaults:
  runtime: tmux
  agent: claude-code
  workspace: worktree
  notifiers: [desktop, telegram]

notifiers:
  telegram:
    plugin: webhook
    url: "http://localhost:8787"

notificationRouting:
  urgent: [desktop, telegram]
  action: [desktop, telegram]
  warning: [telegram]
  info: [telegram]

reactions:
  ci-failed:
    auto: true
    action: send-to-agent
    message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
    retries: 2
    escalateAfter: 2
  changes-requested:
    auto: true
    action: send-to-agent
    message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
    escalateAfter: 30m
  issue-commented:
    auto: true
    action: send-to-agent
    filter:
      authors: ["marcmantei"]
    escalateAfter: 30m
  auto-review:
    auto: true
    action: spawn-reviewer
    script: /home/sira/.openclaw/agent-orchestrator/scripts/pr-auto-review
    retries: 1
    escalateAfter: 1

projects:
  chargepilot:
    name: ChargePilot Launch
    repo: marcmantei/ChargePilot-Launch
    path: ~/ChargePilot-Launch
    defaultBranch: main
    sessionPrefix: cp
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: opus
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent

  chargepilot-app:
    name: ChargePilot App
    repo: marcmantei/ChargePilot-App
    path: ~/ChargePilot-App
    defaultBranch: main
    sessionPrefix: cpa
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: opus
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent

  getchargepilot:
    name: getchargepilot.app
    repo: marcmantei/getchargepilot.app
    path: ~/getchargepilot.app
    defaultBranch: main
    sessionPrefix: gcp
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: sonnet
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent

  mitbeziehung:
    name: mitbeziehung.de
    repo: marcmantei/mitbeziehung.de
    path: ~/mitbeziehung.de
    defaultBranch: main
    sessionPrefix: mb
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: sonnet
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent

  event-platform:
    name: Event Management Platform
    repo: marcmantei/event-management-platform
    path: ~/event-management-platform
    defaultBranch: main
    sessionPrefix: emp
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: opus
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent

  agent-orchestrator:
    name: Agent Orchestrator
    repo: marcmantei/agent-orchestrator
    path: ~/.openclaw/agent-orchestrator
    defaultBranch: main
    sessionPrefix: ao
    tracker:
      plugin: github
    scm:
      plugin: github
    symlinks: [.claude]
    postCreate:
      - "test -f package.json && pnpm install || true"
    agentConfig:
      permissions: skip
      model: opus
    agentRulesFile: .agent-rules.md
    reactions:
      ci-failed:
        auto: true
        action: send-to-agent
        message: "CI is failing on your PR. Run the failing checks locally, fix the issues, and push."
        retries: 2
        escalateAfter: 2
      changes-requested:
        auto: true
        action: send-to-agent
        message: "Review comments were left on your PR. Run `gh pr view --comments` to read them, address the feedback, and push fixes."
        escalateAfter: 30m
      approved-and-green:
        auto: false
        action: notify
        priority: action
      agent-stuck:
        threshold: 10m
        action: notify
        priority: urgent
